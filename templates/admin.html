<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Static Navigation - SB Admin</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link href="style.css" rel="stylesheet" />
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <!-- TOP NAVBAR -->
        <nav class="sb-topnav navbar navbar-expand navbar-dark ">

            <!-- Sidebar Toggle-->
            <button
                class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0"
                id="sidebarToggle"
                href="#!">
                <i class="fas fa-bars"></i>
            </button>

   
            <a class="nav-link" href="#!">
                <i class="fas fa-user fa-fw"></i>
            </a>

        </nav>

        <div id="layoutSidenav">
            <!-- SIDENAV SINISTRA -->
            <div id="layoutSidenav_nav">
                <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
                    <div class="sb-sidenav-menu">
                        <div class="nav">
                            <a class="nav-link" href="index.html">
                                <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
                                Dashboard
                            </a>
                            <a class="nav-link" href="#!">
                                <div class="sb-nav-link-icon"><i class="fas fa-cog"></i></div>
                                Settings
                            </a>
                            <a class="nav-link" href="#!">
                                <div class="sb-nav-link-icon"><i class="fas fa-list"></i></div>
                                Feeds
                            </a>
                            <a class="nav-link" href="#!">
                                <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt"></i></div>
                                Logout
                            </a>
                        </div>
                    </div>

                    <!-- Footer della sidenav -->
                    <div class="sb-sidenav-footer">
                        <div class="small">Logged in as:</div>
                        Admin:
                    </div>
                </nav>
            </div>

            <!-- CONTENUTO PRINCIPALE -->
            <div id="layoutSidenav_content">
                <main>
                    <div class="container py-5">
    <h2 class="mb-4 text-center">Admin - Gestione Post</h2>

    <!-- TOP 3 POST PIÙ COMMENTATI -->
    <h3 class="section-title">Top 3 Post Più Commentati</h3>
    <div id="topPostsContainer" class="row g-4 mb-5">
        <!-- Top 3 post caricati dinamicamente qui -->
    </div>

    <!-- POST IN SOSPESO -->
    <h3 class="section-title">Post in Sospeso</h3>
    <div id="pendingPostsContainer" class="row g-4 mb-5">
        <!-- I post in sospeso saranno caricati qui -->
    </div>

    <!-- POST SEGNALATI -->
    <h3 class="section-title">Post Segnalati</h3>
    <div id="reportedPostsContainer" class="row g-4 mb-5">
        <!-- I post segnalati saranno caricati qui -->
    </div>
</div>

<!-- Bootstrap JS -->
                </main>

                    <footer class="py-4 bg-light mt-auto">
                        <div class="container-fluid px-4">
                            <div class="d-flex align-items-center justify-content-between small">
                                <div class="text-muted">Copyright &copy; Your Website 2023</div>
                                <div>
                                    <a href="#">Privacy Policy</a>
                                    &middot;
                                    <a href="#">Terms &amp; Conditions</a>
                                </div>
                            </div>
                        </div>
                    </footer>
            </div>
        </div>

        <!-- JS -->
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            crossorigin="anonymous"
        ></script>
        <script src="script.js"></script>
        <script>
    // Esempio di dati
    const topPosts = [
        {id: 101, testo: "Post più commentato 1", comment_count: 45, author: "Alice", data: "2026-02-01"},
        {id: 102, testo: "Post più commentato 2", comment_count: 30, author: "Bob", data: "2026-02-02"},
        {id: 103, testo: "Post più commentato 3", comment_count: 25, author: "Carla", data: "2026-02-02"}
    ];

    const pendingPosts = [
        {id: 1, testo: "Post 1 da approvare", data: "2026-02-03 10:00", author: "Mario"},
        {id: 2, testo: "Post 2 da approvare", data: "2026-02-03 11:00", author: "Luigi"},
        {id: 3, testo: "Post 3 da approvare", data: "2026-02-03 12:00", author: "Anna"}
    ];

    const reportedPosts = [
        {id: 201, testo: "Post segnalato 1", author: "Paolo", data: "2026-02-02", motivo: "Spam"},
        {id: 202, testo: "Post segnalato 2", author: "Sara", data: "2026-02-02", motivo: "Offensivo"}
    ];

    const topPostsContainer = document.getElementById("topPostsContainer");
    const pendingPostsContainer = document.getElementById("pendingPostsContainer");
    const reportedPostsContainer = document.getElementById("reportedPostsContainer");

    // Render Top 3 Post più commentati
    function renderTopPosts() {
        topPostsContainer.innerHTML = "";
        if(topPosts.length === 0){
            topPostsContainer.innerHTML = `<p class="no-post">Nessun post da mostrare</p>`;
            return;
        }
        topPosts.forEach(post => {
            const col = document.createElement("div");
            col.classList.add("col-12", "col-lg-4");
            /* col.classList.add("col");
            col.style.flex = "0 0 300px";
            col.style.maxWidth = "300px"; */
            col.innerHTML = `
                <div class="card spotted-post h-100">
                <div class="card-body d-flex flex-column h-100">

                    <!-- HEADER -->
                    <div class="d-flex justify-content-between align-items-center mb-3 spotted-header">
                        <span class="spotted-time">
                            ${post.data}
                        </span>

                    </div>

                    <!-- TESTO CENTRATO -->
                    <div class="flex-grow-1 d-flex align-items-center justify-content-center">
                        <p class="spotted-text text-center m-0">
                            ${post.testo}
                        </p>
                    </div>

                </div>
            </div>
        </div>
            `;
            topPostsContainer.appendChild(col);
        });

    }

    // Render Pending Posts
    function renderPendingPosts() {
        pendingPostsContainer.innerHTML = "";
        if(pendingPosts.length === 0){
            pendingPostsContainer.innerHTML = `<p class="no-post">Nessun post in sospeso</p>`;
            return;
        }
        pendingPosts.forEach(post => {
            const col = document.createElement("div");
            col.classList.add("col-12", "col-lg-4");
            col.innerHTML = `
            <div class="card spotted-post h-100">
                <div class="card-body d-flex flex-column h-100">

                    <!-- HEADER -->
                    <div class="d-flex justify-content-between align-items-center mb-3 spotted-header">
                        <span class="spotted-time">
                            ${post.data}
                        </span>

                    </div>

                    <!-- TESTO CENTRATO -->
                    <div class="flex-grow-1 d-flex align-items-center justify-content-center">
                        <p class="spotted-text text-center m-0">
                            ${post.testo}
                        </p>
                    </div>

                    <!-- FOOTER -->
                    <div class="mt-3 text-center d-flex justify-content-between gap-2">
                        <button
                            type="button"
                            class="btn btn-success btn-respond btn-approve"
                            data-id="${post.id}"
                            id="btnApprove">
                            Approve
                        </button>
                        <button
                            type="button"
                            class="btn btn-danger btn-respond btn-decline"
                            data-id="${post.id}"
                            id="btnDecline">
                            
                            Decline
                        </button>
                    </div>

                </div>
            </div>
        </div>`
            ;
            pendingPostsContainer.appendChild(col);
        });
    }

    // Render Reported Posts
    function renderReportedPosts() {
    reportedPostsContainer.innerHTML = "";
    if(reportedPosts.length === 0){
        reportedPostsContainer.innerHTML = `<p class="no-post">Nessun post segnalato</p>`;
        return;
    }
    reportedPosts.forEach(post => {
        const col = document.createElement("div");
        col.classList.add("col-12", "col-lg-4");
        col.innerHTML = `
            <div class="card spotted-post h-100">
                <div class="card-body d-flex flex-column h-100">
                    <!-- HEADER -->
                    <div class="d-flex justify-content-between align-items-center mb-3 spotted-header">
                        <span class="spotted-time">
                            ${post.data}
                        </span>
                    </div>

                    <!-- TESTO CENTRATO -->
                    <div class="flex-grow-1 d-flex align-items-center justify-content-center">
                        <p class="spotted-text text-center m-0">
                            ${post.testo}
                        </p>
                    </div>

                    <!-- FOOTER CON PULSANTI -->
                    <div class="mt-3 text-center d-flex justify-content-between gap-2">
                        <button
                            type="button"
                            class="btn btn-respond btn-normalize"
                            data-id="${post.id}">
                            Togli segnalazione
                        </button>
                        <button
                            type="button"
                            class="btn btn-respond btn-remove"
                            data-id="${post.id}">
                            Rimuovi
                        </button>
                    </div>
                </div>
            </div>
        `;
        reportedPostsContainer.appendChild(col);
    });
}
    // Render iniziale
    renderTopPosts();
    renderPendingPosts();
    renderReportedPosts();

    // Event delegation per pulsanti Approva/Rifiuta
    document.addEventListener("click", function(e){
        const approveBtn = e.target.closest(".btn-approve");
        const declineBtn = e.target.closest(".btn-decline");

        if(approveBtn) {
            const postId = approveBtn.dataset.id;
            console.log("Approva post id:", postId);
            alert(`Post ${postId} approvato!`);
            removePendingPost(postId);
        }

        if(declineBtn) {
            const postId = declineBtn.dataset.id;
            console.log("Rifiuta post id:", postId);
            alert(`Post ${postId} rifiutato!`);
            removePendingPost(postId);
        }
    });
    document.addEventListener("click", function(e){
        const normalizeBtn = e.target.closest(".btn-normalize");
        const removeBtn = e.target.closest(".btn-remove");

        if(normalizeBtn) {
            const postId = normalizeBtn.dataset.id;
            alert(`Post ${postId} reso normale!`);
            moveReportedToPending(postId);
        }

        if(removeBtn) {
            const postId = removeBtn.dataset.id;
            alert(`Post ${postId} rimosso definitivamente!`);
            removeReportedPost(postId);
        }
    });

    function removePendingPost(postId) {
        const index = pendingPosts.findIndex(p => p.id == postId);
        if(index !== -1){
            pendingPosts.splice(index,1);
            renderPendingPosts();
        }
    }
    function moveReportedToPending(postId) {
        const index = reportedPosts.findIndex(p => p.id == postId);
        if(index !== -1){
            const post = reportedPosts.splice(index,1)[0];
            pendingPosts.push(post); // oppure in "approvati" se vuoi
            renderReportedPosts();
            renderPendingPosts();
        }
    }

    function removeReportedPost(postId) {
        const index = reportedPosts.findIndex(p => p.id == postId);
        if(index !== -1){
            reportedPosts.splice(index,1);
            renderReportedPosts();
        }
    }
</script>
    </body>

</html>

